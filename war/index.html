<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>GDGChugokuSample</title>
</head>
<body>
	<a id="login" href="">ログイン</a>
	<input type="button" id="refresh_button" value="refresh" />
	<div id="todo_list"></div>
	<hr />

	ToDoを入れてね！
	<input type="text" id="memo" />
	<input type="button" id="add_button" value="add" />

	<script
		src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script>
		window.jQuery
				|| document
						.write('<script src="/lib/jquery/jquery-1.7.2.min.js"><\/script>')
	</script>
	<script>
		function refresh() {
			$.ajax({
				url : '/toDo',
				type : 'GET',
				success : function(data, status, xhr) {
					console.log('success')
					if (data['loginUrl']) {
						$('#login').attr('href', data['loginUrl']);
					}
					$('#todo_list').html(data);
					console.log(data['loginUrl']);
				},
				error : function(data, status, xhr) {
					console.log('error');
				}
			});
		}
		
		$(document).ready(function() {
			refresh();
			
			$('#refresh_button').click(function() {
				refresh();
			});

			$("#add_button").click(function() {
				$.ajax({
					url : '/toDo',
					type : 'POST',
					data : {
						memo : $('#memo').value,
					},
					dataType : 'application/json',
					success: function(data, status, xhr) {
				        console.log('success');
						console.log(data);
				    },
					error : function(data, status, xhr) {
						console.log('error');
						console.log(data);
						console.log(status);
						console.log(xhr);
					}
				});
			});
		});
	</script>
</body>
</html>
